   1               		.file	"assembler.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
  10               		.text
  11               	.Ltext0:
 351               		.section	.rodata.str1.1,"aMS",@progbits,1
 352               	.LC0:
 353 0000 2564 3A25 		.string	"%d:%d:%d:%d:%d"
 353      643A 2564 
 353      3A25 643A 
 353      2564 00
 354               	.LC1:
 355 000f 2564 3A25 		.string	"%d:%d:%d:%d:%d,%d,%d"
 355      643A 2564 
 355      3A25 643A 
 355      2564 2C25 
 355      642C 2564 
 356               		.text
 359               	.global	assemble_serv_packet
 361               	assemble_serv_packet:
 362               		.stabd	46,0,0
   1:../../../projects/dicio/utility/assembler.c **** /**
   2:../../../projects/dicio/utility/assembler.c ****  * 18-748 Wireless Sensor Networks
   3:../../../projects/dicio/utility/assembler.c ****  * Spring 2016
   4:../../../projects/dicio/utility/assembler.c ****  * Lab 3: Multi-Hop Communication
   5:../../../projects/dicio/utility/assembler.c ****  * assembler.c
   6:../../../projects/dicio/utility/assembler.c ****  * Kedar Amladi // kamladi. Daniel Santoro // ddsantor. Adam Selevan // aselevan.
   7:../../../projects/dicio/utility/assembler.c ****  */
   8:../../../projects/dicio/utility/assembler.c ****  
   9:../../../projects/dicio/utility/assembler.c **** #include <assembler.h>
  10:../../../projects/dicio/utility/assembler.c **** 
  11:../../../projects/dicio/utility/assembler.c **** 
  12:../../../projects/dicio/utility/assembler.c **** /*
  13:../../../projects/dicio/utility/assembler.c **** Assemble packet to go to the server.
  14:../../../projects/dicio/utility/assembler.c **** Right now the server is looking for ":"
  15:../../../projects/dicio/utility/assembler.c **** */
  16:../../../projects/dicio/utility/assembler.c **** void assemble_serv_packet(uint8_t *tx_buf, packet *tx)
  17:../../../projects/dicio/utility/assembler.c **** {
 364               	.LM0:
 365               	.LFBB1:
 366               	/* prologue: function */
 367               	/* frame size = 0 */
 368               	/* stack size = 0 */
 369               	.L__stack_usage = 0
 370 0000 FB01      		movw r30,r22
  18:../../../projects/dicio/utility/assembler.c ****     switch(tx->type)
 372               	.LM1:
 373 0002 2181      		ldd r18,Z+1
 374 0004 2530      		cpi r18,lo8(5)
 375 0006 01F0      		breq .L3
 376 0008 2630      		cpi r18,lo8(6)
 377 000a 01F0      		breq .+2
 378 000c 00C0      		rjmp .L1
  19:../../../projects/dicio/utility/assembler.c ****     {
  20:../../../projects/dicio/utility/assembler.c ****         case MSG_CMD:
  21:../../../projects/dicio/utility/assembler.c ****         {
  22:../../../projects/dicio/utility/assembler.c ****             // msg_cmd from server has num_hops of 0.
  23:../../../projects/dicio/utility/assembler.c ****             // cmd type message will only have "ON/OFF" payload value.
  24:../../../projects/dicio/utility/assembler.c ****             // Will this ever happen? 
  25:../../../projects/dicio/utility/assembler.c ****             sprintf(tx_buf, "%d:%d:%d:%d:%d", tx->source_id, tx->seq_num, tx->type, tx->num_hops, t
 380               	.LM2:
 381 000e 3185      		ldd r19,Z+9
 382 0010 1F92      		push __zero_reg__
 383 0012 3F93      		push r19
 384 0014 3481      		ldd r19,Z+4
 385 0016 1F92      		push __zero_reg__
 386 0018 3F93      		push r19
 387 001a 1F92      		push __zero_reg__
 388 001c 2F93      		push r18
 389 001e 2381      		ldd r18,Z+3
 390 0020 2F93      		push r18
 391 0022 2281      		ldd r18,Z+2
 392 0024 2F93      		push r18
 393 0026 2081      		ld r18,Z
 394 0028 1F92      		push __zero_reg__
 395 002a 2F93      		push r18
 396 002c 20E0      		ldi r18,lo8(.LC0)
 397 002e 30E0      		ldi r19,hi8(.LC0)
 398 0030 3F93      		push r19
 399 0032 2F93      		push r18
 400 0034 9F93      		push r25
 401 0036 8F93      		push r24
 402 0038 0E94 0000 		call sprintf
  26:../../../projects/dicio/utility/assembler.c ****             break;
 404               	.LM3:
 405 003c 8DB7      		in r24,__SP_L__
 406 003e 9EB7      		in r25,__SP_H__
 407 0040 0E96      		adiw r24,14
 408 0042 0FB6      		in __tmp_reg__,__SREG__
 409 0044 F894      		cli
 410 0046 9EBF      		out __SP_H__,r25
 411 0048 0FBE      		out __SREG__,__tmp_reg__
 412 004a 8DBF      		out __SP_L__,r24
 413 004c 0895      		ret
 414               	.L3:
  27:../../../projects/dicio/utility/assembler.c ****         }
  28:../../../projects/dicio/utility/assembler.c **** 
  29:../../../projects/dicio/utility/assembler.c ****         case MSG_DATA:
  30:../../../projects/dicio/utility/assembler.c ****         {
  31:../../../projects/dicio/utility/assembler.c ****             // NEED TO TEST
  32:../../../projects/dicio/utility/assembler.c ****             sprintf(tx_buf, "%d:%d:%d:%d:%d,%d,%d", tx->source_id, tx->seq_num, tx->type, tx->num_h
 416               	.LM4:
 417 004e 3585      		ldd r19,Z+13
 418 0050 1F92      		push __zero_reg__
 419 0052 3F93      		push r19
 420 0054 3385      		ldd r19,Z+11
 421 0056 1F92      		push __zero_reg__
 422 0058 3F93      		push r19
 423 005a 3185      		ldd r19,Z+9
 424 005c 1F92      		push __zero_reg__
 425 005e 3F93      		push r19
 426 0060 3481      		ldd r19,Z+4
 427 0062 1F92      		push __zero_reg__
 428 0064 3F93      		push r19
 429 0066 1F92      		push __zero_reg__
 430 0068 2F93      		push r18
 431 006a 2381      		ldd r18,Z+3
 432 006c 2F93      		push r18
 433 006e 2281      		ldd r18,Z+2
 434 0070 2F93      		push r18
 435 0072 2081      		ld r18,Z
 436 0074 1F92      		push __zero_reg__
 437 0076 2F93      		push r18
 438 0078 20E0      		ldi r18,lo8(.LC1)
 439 007a 30E0      		ldi r19,hi8(.LC1)
 440 007c 3F93      		push r19
 441 007e 2F93      		push r18
 442 0080 9F93      		push r25
 443 0082 8F93      		push r24
 444 0084 0E94 0000 		call sprintf
 445 0088 8DB7      		in r24,__SP_L__
 446 008a 9EB7      		in r25,__SP_H__
 447 008c 4296      		adiw r24,18
 448 008e 0FB6      		in __tmp_reg__,__SREG__
 449 0090 F894      		cli
 450 0092 9EBF      		out __SP_H__,r25
 451 0094 0FBE      		out __SREG__,__tmp_reg__
 452 0096 8DBF      		out __SP_L__,r24
 453               	.L1:
 454 0098 0895      		ret
 456               	.Lscope1:
 458               		.stabd	78,0,0
 462               	.global	assemble_packet
 464               	assemble_packet:
 465               		.stabd	46,0,0
  33:../../../projects/dicio/utility/assembler.c ****                 (uint16_t)tx->payload[DATA_PWR_INDEX], (uint16_t)tx->payload[DATA_TEMP_INDEX],
  34:../../../projects/dicio/utility/assembler.c ****                  (uint16_t)tx->payload[DATA_LIGHT_INDEX]);
  35:../../../projects/dicio/utility/assembler.c ****         }
  36:../../../projects/dicio/utility/assembler.c ****         case MSG_NODE_SENSOR_VALUE:
  37:../../../projects/dicio/utility/assembler.c ****         {
  38:../../../projects/dicio/utility/assembler.c ****             break;
  39:../../../projects/dicio/utility/assembler.c ****         }
  40:../../../projects/dicio/utility/assembler.c ****         
  41:../../../projects/dicio/utility/assembler.c ****         case MSG_GATEWAY:
  42:../../../projects/dicio/utility/assembler.c ****         {
  43:../../../projects/dicio/utility/assembler.c ****             break;
  44:../../../projects/dicio/utility/assembler.c ****         }
  45:../../../projects/dicio/utility/assembler.c ****     }
  46:../../../projects/dicio/utility/assembler.c **** }
  47:../../../projects/dicio/utility/assembler.c **** 
  48:../../../projects/dicio/utility/assembler.c **** /*
  49:../../../projects/dicio/utility/assembler.c **** Assemble packet to go to the network.
  50:../../../projects/dicio/utility/assembler.c **** Use network format.
  51:../../../projects/dicio/utility/assembler.c **** */
  52:../../../projects/dicio/utility/assembler.c **** uint8_t assemble_packet(uint8_t *tx_buf, packet *tx)
  53:../../../projects/dicio/utility/assembler.c **** {
 467               	.LM5:
 468               	.LFBB2:
 469               	/* prologue: function */
 470               	/* frame size = 0 */
 471               	/* stack size = 0 */
 472               	.L__stack_usage = 0
 473 009a DC01      		movw r26,r24
 474 009c FB01      		movw r30,r22
  54:../../../projects/dicio/utility/assembler.c ****     uint8_t length = 0;
  55:../../../projects/dicio/utility/assembler.c ****     switch(tx->type)
 476               	.LM6:
 477 009e 8181      		ldd r24,Z+1
 478 00a0 8530      		cpi r24,lo8(5)
 479 00a2 01F0      		breq .L8
 480 00a4 8630      		cpi r24,lo8(6)
 481 00a6 01F0      		breq .+2
 482 00a8 00C0      		rjmp .L11
  56:../../../projects/dicio/utility/assembler.c ****     {
  57:../../../projects/dicio/utility/assembler.c ****         case MSG_CMD:
  58:../../../projects/dicio/utility/assembler.c ****         {
  59:../../../projects/dicio/utility/assembler.c ****             length = 8;
  60:../../../projects/dicio/utility/assembler.c ****             // msg_cmd from server has hop_num of 0.
  61:../../../projects/dicio/utility/assembler.c ****             // cmd type message will only have "ON/OFF" payload value.
  62:../../../projects/dicio/utility/assembler.c ****             tx_buf[0] = tx->source_id;
 484               	.LM7:
 485 00aa 8081      		ld r24,Z
 486 00ac 8C93      		st X,r24
  63:../../../projects/dicio/utility/assembler.c ****             tx_buf[1] = tx->seq_num;
 488               	.LM8:
 489 00ae 8281      		ldd r24,Z+2
 490 00b0 1196      		adiw r26,1
 491 00b2 8C93      		st X,r24
 492 00b4 1197      		sbiw r26,1
  64:../../../projects/dicio/utility/assembler.c ****             tx_buf[2] = tx->type;
 494               	.LM9:
 495 00b6 8181      		ldd r24,Z+1
 496 00b8 1296      		adiw r26,2
 497 00ba 8C93      		st X,r24
 498 00bc 1297      		sbiw r26,2
  65:../../../projects/dicio/utility/assembler.c ****             tx_buf[3] = tx->num_hops;
 500               	.LM10:
 501 00be 8481      		ldd r24,Z+4
 502 00c0 1396      		adiw r26,3
 503 00c2 8C93      		st X,r24
 504 00c4 1397      		sbiw r26,3
  66:../../../projects/dicio/utility/assembler.c ****             tx_buf[4] = tx->payload[0];
 506               	.LM11:
 507 00c6 8185      		ldd r24,Z+9
 508 00c8 1496      		adiw r26,4
 509 00ca 8C93      		st X,r24
 510 00cc 1497      		sbiw r26,4
  67:../../../projects/dicio/utility/assembler.c ****             tx_buf[5] = tx->payload[1];
 512               	.LM12:
 513 00ce 8285      		ldd r24,Z+10
 514 00d0 1596      		adiw r26,5
 515 00d2 8C93      		st X,r24
 516 00d4 1597      		sbiw r26,5
  68:../../../projects/dicio/utility/assembler.c ****             tx_buf[6] = tx->payload[2];
 518               	.LM13:
 519 00d6 8385      		ldd r24,Z+11
 520 00d8 1696      		adiw r26,6
 521 00da 8C93      		st X,r24
 522 00dc 1697      		sbiw r26,6
  69:../../../projects/dicio/utility/assembler.c ****             tx_buf[7] = tx->payload[3];
 524               	.LM14:
 525 00de 8485      		ldd r24,Z+12
 526 00e0 1796      		adiw r26,7
 527 00e2 8C93      		st X,r24
  59:../../../projects/dicio/utility/assembler.c ****             // msg_cmd from server has hop_num of 0.
 529               	.LM15:
 530 00e4 88E0      		ldi r24,lo8(8)
  70:../../../projects/dicio/utility/assembler.c ****             break;
 532               	.LM16:
 533 00e6 0895      		ret
 534               	.L8:
  71:../../../projects/dicio/utility/assembler.c ****         }
  72:../../../projects/dicio/utility/assembler.c **** 
  73:../../../projects/dicio/utility/assembler.c ****         case MSG_DATA:
  74:../../../projects/dicio/utility/assembler.c ****         {
  75:../../../projects/dicio/utility/assembler.c ****             length = 10;
  76:../../../projects/dicio/utility/assembler.c ****             // NEED TO TEST/DEVELOP!!
  77:../../../projects/dicio/utility/assembler.c ****             // MISSING NUMBER HOPS
  78:../../../projects/dicio/utility/assembler.c ****             // msg_cmd from server has hop_num of 0.
  79:../../../projects/dicio/utility/assembler.c ****             // cmd type message will only have "ON/OFF" payload value.
  80:../../../projects/dicio/utility/assembler.c ****             tx_buf[0] = tx->source_id;
 536               	.LM17:
 537 00e8 8081      		ld r24,Z
 538 00ea 8C93      		st X,r24
  81:../../../projects/dicio/utility/assembler.c ****             tx_buf[1] = tx->seq_num;
 540               	.LM18:
 541 00ec 8281      		ldd r24,Z+2
 542 00ee 1196      		adiw r26,1
 543 00f0 8C93      		st X,r24
 544 00f2 1197      		sbiw r26,1
  82:../../../projects/dicio/utility/assembler.c ****             tx_buf[2] = tx->type;
 546               	.LM19:
 547 00f4 8181      		ldd r24,Z+1
 548 00f6 1296      		adiw r26,2
 549 00f8 8C93      		st X,r24
 550 00fa 1297      		sbiw r26,2
  83:../../../projects/dicio/utility/assembler.c ****             tx_buf[3] = tx->num_hops;
 552               	.LM20:
 553 00fc 8481      		ldd r24,Z+4
 554 00fe 1396      		adiw r26,3
 555 0100 8C93      		st X,r24
 556 0102 1397      		sbiw r26,3
  84:../../../projects/dicio/utility/assembler.c ****             tx_buf[4] = tx->payload[0];
 558               	.LM21:
 559 0104 8185      		ldd r24,Z+9
 560 0106 1496      		adiw r26,4
 561 0108 8C93      		st X,r24
 562 010a 1497      		sbiw r26,4
  85:../../../projects/dicio/utility/assembler.c ****             tx_buf[5] = tx->payload[1];
 564               	.LM22:
 565 010c 8285      		ldd r24,Z+10
 566 010e 1596      		adiw r26,5
 567 0110 8C93      		st X,r24
 568 0112 1597      		sbiw r26,5
  86:../../../projects/dicio/utility/assembler.c ****             tx_buf[6] = tx->payload[2];
 570               	.LM23:
 571 0114 8385      		ldd r24,Z+11
 572 0116 1696      		adiw r26,6
 573 0118 8C93      		st X,r24
 574 011a 1697      		sbiw r26,6
  87:../../../projects/dicio/utility/assembler.c ****             tx_buf[7] = tx->payload[3];
 576               	.LM24:
 577 011c 8485      		ldd r24,Z+12
 578 011e 1796      		adiw r26,7
 579 0120 8C93      		st X,r24
 580 0122 1797      		sbiw r26,7
  88:../../../projects/dicio/utility/assembler.c ****             tx_buf[8] = tx->payload[4];
 582               	.LM25:
 583 0124 8585      		ldd r24,Z+13
 584 0126 1896      		adiw r26,8
 585 0128 8C93      		st X,r24
 586 012a 1897      		sbiw r26,8
  89:../../../projects/dicio/utility/assembler.c ****             tx_buf[9] = tx->payload[5];
 588               	.LM26:
 589 012c 8685      		ldd r24,Z+14
 590 012e 1996      		adiw r26,9
 591 0130 8C93      		st X,r24
  75:../../../projects/dicio/utility/assembler.c ****             // NEED TO TEST/DEVELOP!!
 593               	.LM27:
 594 0132 8AE0      		ldi r24,lo8(10)
 595 0134 0895      		ret
 596               	.L11:
  54:../../../projects/dicio/utility/assembler.c ****     switch(tx->type)
 598               	.LM28:
 599 0136 80E0      		ldi r24,0
  90:../../../projects/dicio/utility/assembler.c ****         }
  91:../../../projects/dicio/utility/assembler.c ****         case MSG_NODE_SENSOR_VALUE:
  92:../../../projects/dicio/utility/assembler.c ****         {/*
  93:../../../projects/dicio/utility/assembler.c ****             sprintf (tx_buf, "[%d][%d][%d][%d][%d]", tx->type, tx->source_id, tx->seq_num, 
  94:../../../projects/dicio/utility/assembler.c ****             tx->num_hops, tx->light_value);*/
  95:../../../projects/dicio/utility/assembler.c ****             break;
  96:../../../projects/dicio/utility/assembler.c ****         }
  97:../../../projects/dicio/utility/assembler.c ****         
  98:../../../projects/dicio/utility/assembler.c ****         case MSG_GATEWAY:
  99:../../../projects/dicio/utility/assembler.c ****         {/*
 100:../../../projects/dicio/utility/assembler.c ****           sprintf (tx_buf, "[%d][%d][%d][%d][%d][%d]", tx->type, tx->source_id, tx->seq_num, 
 101:../../../projects/dicio/utility/assembler.c ****           tx->num_hops, tx->sensor_sample_rate, tx->neighbor_update_rate);*/
 102:../../../projects/dicio/utility/assembler.c ****             break;
 103:../../../projects/dicio/utility/assembler.c ****         }
 104:../../../projects/dicio/utility/assembler.c ****     }
 105:../../../projects/dicio/utility/assembler.c ****     return length;
 106:../../../projects/dicio/utility/assembler.c **** }...
 601               	.LM29:
 602 0138 0895      		ret
 607               	.Lscope2:
 609               		.stabd	78,0,0
 610               		.comm	error_num,1,1
 611               		.comm	error_task,1,1
 612               		.comm	bmac_rfTxInfo,7,1
 613               		.comm	bmac_rfRxInfo,12,1
 614               		.comm	bmac_enable_signal,1,1
 615               		.comm	bmac_tx_pkt_done_signal,1,1
 616               		.comm	bmac_rx_pkt_signal,1,1
 617               		.comm	nrk_kernel_stk_ptr,2,1
 618               		.comm	nrk_idle_task_stk,512,1
 619               		.comm	_nrk_signal_list,4,1
 631               	.Letext0:
 632               		.ident	"GCC: (GNU) 4.9.1"
 633               	.global __do_copy_data
 634               	.global __do_clear_bss
DEFINED SYMBOLS
                            *ABS*:0000000000000000 assembler.c
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:4      *ABS*:000000000000003f __SREG__
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:5      *ABS*:000000000000003b __RAMPZ__
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:6      *ABS*:0000000000000000 __tmp_reg__
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:7      *ABS*:0000000000000001 __zero_reg__
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:361    .text:0000000000000000 assemble_serv_packet
/var/folders/57/dy66zcf543x9s42pt1yfw30r0000gn/T//cc8Ll2fy.s:464    .text:000000000000009a assemble_packet
                            *COM*:0000000000000001 error_num
                            *COM*:0000000000000001 error_task
                            *COM*:0000000000000007 bmac_rfTxInfo
                            *COM*:000000000000000c bmac_rfRxInfo
                            *COM*:0000000000000001 bmac_enable_signal
                            *COM*:0000000000000001 bmac_tx_pkt_done_signal
                            *COM*:0000000000000001 bmac_rx_pkt_signal
                            *COM*:0000000000000002 nrk_kernel_stk_ptr
                            *COM*:0000000000000200 nrk_idle_task_stk
                            *COM*:0000000000000004 _nrk_signal_list

UNDEFINED SYMBOLS
sprintf
__do_copy_data
__do_clear_bss
